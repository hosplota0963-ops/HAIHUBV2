-- à¹ƒà¸ªà¹ˆà¹ƒà¸™ GitHub à¹à¸—à¸™à¸ªà¸„à¸£à¸´à¸›à¸•à¹Œà¹€à¸”à¸´à¸¡
local encoded = "à¹ƒà¸ªà¹ˆà¹‚à¸„à¹‰à¸” Base64 à¸—à¸µà¹ˆà¸„à¸±à¸”à¸¥à¸­à¸à¹„à¸”à¹‰à¸•à¸£à¸‡à¸™à¸µà¹‰"

local function base64Decode(data)
    local b64chars = 'bG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIFJFUVVJUkVEX0tFWSA9ICJteXNlY3JldGtleSIgIC0tIOC4geC4s+C4q+C4meC4lOC4hOC4teC4ouC5jOC4l+C4teC5iOC4leC5ieC4reC4h+C5g+C4quC5iOC4geC5iOC4reC4meC5g+C4iuC5ieC4h+C4suC4mQoKLS0gU2VydmljZXMg4Liq4Liz4Lir4Lij4Lix4Lia4Lif4Lix4LiH4LiB4LmM4LiK4Lix4LiZ4LmD4Lir4Lih4LmICmxvY2FsIFVJUyA9IGdhbWU6R2V0U2VydmljZSgiVXNlcklucHV0U2VydmljZSIpCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCBMaWdodGluZyA9IGdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKQpsb2NhbCBTdGFydGVyR3VpID0gZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIikKbG9jYWwgVHdlZW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikKCi0tIOC4quC4o+C5ieC4suC4hyBVSSDguYPguKrguYjguITguLXguKLguYzguYHguJrguJrguKrguKfguKLguIfguLLguKHguYDguK3guIcKbG9jYWwgVmFsaWRhdGVLZXlVSSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKVmFsaWRhdGVLZXlVSS5OYW1lID0gIkhhaUh1YktleVN5c3RlbSIKVmFsaWRhdGVLZXlVSS5QYXJlbnQgPSBwbGF5ZXI6V2FpdEZvckNoaWxkKCJQbGF5ZXJHdWkiKQpWYWxpZGF0ZUtleVVJLlJlc2V0T25TcGF3biA9IGZhbHNlClZhbGlkYXRlS2V5VUkuWkluZGV4QmVoYXZpb3IgPSBFbnVtLlpJbmRleEJlaGF2aW9yLlNpYmxpbmcKCi0tIE1haW4gRnJhbWUg4Lie4Lij4LmJ4Lit4Lih4LmA4Lit4Lif4LmA4Lif4LiB4LiV4LmM4Liq4Lin4Lii4LiH4Liy4LihCmxvY2FsIE1haW5GcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQpNYWluRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLCA1MDAsIDAsIDM1MCkKTWFpbkZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTI1MCwgMC41LCAtMTc1KQpNYWluRnJhbWUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDE4LCAxOCwgMjUpCk1haW5GcmFtZS5Cb3JkZXJTaXplUGl4ZWwgPSAwCk1haW5GcmFtZS5BbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMC41KQpNYWluRnJhbWUuUGFyZW50ID0gVmFsaWRhdGVLZXlVSQoKbG9jYWwgVUlDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKVUlDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTIpClVJQ29ybmVyLlBhcmVudCA9IE1haW5GcmFtZQoKbG9jYWwgVUlTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikKVUlTdHJva2UuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAxNjIsIDI1NSkKVUlTdHJva2UuVGhpY2tuZXNzID0gMgpVSVN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjMKVUlTdHJva2UuUGFyZW50ID0gTWFpbkZyYW1lCgotLSBHcmFkaWVudCBCYWNrZ3JvdW5kCmxvY2FsIEJhY2tncm91bmRHcmFkaWVudCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIpCkJhY2tncm91bmRHcmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3ewogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjAsIENvbG9yMy5mcm9tUkdCKDI1LCAyNSwgMzUpKSwKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMS4wLCBDb2xvcjMuZnJvbVJHQigxNSwgMTUsIDIwKSkKfQpCYWNrZ3JvdW5kR3JhZGllbnQuUm90YXRpb24gPSA0NQpCYWNrZ3JvdW5kR3JhZGllbnQuUGFyZW50ID0gTWFpbkZyYW1lCgotLSBUaXRsZSBTZWN0aW9uCmxvY2FsIFRpdGxlRnJhbWUgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKVGl0bGVGcmFtZS5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDgwKQpUaXRsZUZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDApClRpdGxlRnJhbWUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDE2MiwgMjU1KQpUaXRsZUZyYW1lLkJvcmRlclNpemVQaXhlbCA9IDAKVGl0bGVGcmFtZS5QYXJlbnQgPSBNYWluRnJhbWUKCmxvY2FsIFRpdGxlR3JhZGllbnQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQpUaXRsZUdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXd7CiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuMCwgQ29sb3IzLmZyb21SR0IoMCwgMTYyLCAyNTUpKSwKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMS4wLCBDb2xvcjMuZnJvbVJHQigwLCAxMjAsIDIwMCkpCn0KVGl0bGVHcmFkaWVudC5Sb3RhdGlvbiA9IDkwClRpdGxlR3JhZGllbnQuUGFyZW50ID0gVGl0bGVGcmFtZQoKbG9jYWwgVGl0bGVDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKVGl0bGVDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTIpClRpdGxlQ29ybmVyLlBhcmVudCA9IFRpdGxlRnJhbWUKCmxvY2FsIFRpdGxlTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpClRpdGxlTGFiZWwuVGV4dCA9ICLwn5qAIEhBSUhVQiBQUkVNSVVNIEFDQ0VTUyDwn5qAIgpUaXRsZUxhYmVsLlNpemUgPSBVRGltMi5uZXcoMSwgLTIwLCAxLCAwKQpUaXRsZUxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwLCAwLCAwKQpUaXRsZUxhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxClRpdGxlTGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1CbGFjawpUaXRsZUxhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpUaXRsZUxhYmVsLlRleHRTaXplID0gMjQKVGl0bGVMYWJlbC5UZXh0U3Ryb2tlVHJhbnNwYXJlbmN5ID0gMC44ClRpdGxlTGFiZWwuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkNlbnRlcgpUaXRsZUxhYmVsLlBhcmVudCA9IFRpdGxlRnJhbWUKCi0tIFN1YnRpdGxlCmxvY2FsIFN1YnRpdGxlTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpClN1YnRpdGxlTGFiZWwuVGV4dCA9ICLguYPguKrguYjguITguLXguKLguYzguYDguJ7guLfguYjguK3guYDguILguYnguLLguYPguIrguYnguIfguLLguJnguKPguLDguJrguJogUHJlbWl1bSIKU3VidGl0bGVMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIC0yMCwgMCwgMzApClN1YnRpdGxlTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTAsIDAsIDEwMCkKU3VidGl0bGVMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQpTdWJ0aXRsZUxhYmVsLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtU2VtaWJvbGQKU3VidGl0bGVMYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTgwLCAxODAsIDE5MCkKU3VidGl0bGVMYWJlbC5UZXh0U2l6ZSA9IDE2ClN1YnRpdGxlTGFiZWwuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkNlbnRlcgpTdWJ0aXRsZUxhYmVsLlBhcmVudCA9IE1haW5GcmFtZQoKLS0gS2V5IElucHV0IFNlY3Rpb24KbG9jYWwgSW5wdXRGcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQpJbnB1dEZyYW1lLlNpemUgPSBVRGltMi5uZXcoMSwgLTQwLCAwLCA2MCkKSW5wdXRGcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAyMCwgMCwgMTYwKQpJbnB1dEZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigzMCwgMzAsIDQwKQpJbnB1dEZyYW1lLkJvcmRlclNpemVQaXhlbCA9IDAKSW5wdXRGcmFtZS5QYXJlbnQgPSBNYWluRnJhbWUKCmxvY2FsIElucHV0Q29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCklucHV0Q29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDgpCklucHV0Q29ybmVyLlBhcmVudCA9IElucHV0RnJhbWUKCmxvY2FsIElucHV0U3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIpCklucHV0U3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoNjAsIDYwLCA4MCkKSW5wdXRTdHJva2UuVGhpY2tuZXNzID0gMQpJbnB1dFN0cm9rZS5QYXJlbnQgPSBJbnB1dEZyYW1lCgpsb2NhbCBLZXlUZXh0Qm94ID0gSW5zdGFuY2UubmV3KCJUZXh0Qm94IikKS2V5VGV4dEJveC5TaXplID0gVURpbTIubmV3KDEsIC0yMCwgMSwgMCkKS2V5VGV4dEJveC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAxMCwgMCwgMCkKS2V5VGV4dEJveC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQpLZXlUZXh0Qm94LkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZApLZXlUZXh0Qm94LlRleHQgPSAiIgpLZXlUZXh0Qm94LlBsYWNlaG9sZGVyVGV4dCA9ICLwn5SRIOC4geC4o+C4reC4geC4hOC4teC4ouC5jOC4l+C4teC5iOC4meC4teC5iC4uLiIKS2V5VGV4dEJveC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKS2V5VGV4dEJveC5QbGFjZWhvbGRlckNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEyMCwgMTIwLCAxNDApCktleVRleHRCb3guVGV4dFNpemUgPSAxOApLZXlUZXh0Qm94LlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5DZW50ZXIKS2V5VGV4dEJveC5DbGVhclRleHRPbkZvY3VzID0gZmFsc2UKS2V5VGV4dEJveC5QYXJlbnQgPSBJbnB1dEZyYW1lCgotLSBTdWJtaXQgQnV0dG9uCmxvY2FsIFN1Ym1pdEJ1dHRvbiA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpClN1Ym1pdEJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAsIDIwMCwgMCwgNTApClN1Ym1pdEJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC0xMDAsIDAsIDI1MCkKU3VibWl0QnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAyMDAsIDEwMCkKU3VibWl0QnV0dG9uLkJvcmRlclNpemVQaXhlbCA9IDAKU3VibWl0QnV0dG9uLlRleHQgPSAi4pyFIOC4ouC4t+C4meC4ouC4seC4meC5geC4peC4sOC5gOC4guC5ieC4suC5g+C4iuC5ieC4h+C4suC4mSIKU3VibWl0QnV0dG9uLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQmxhY2sKU3VibWl0QnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpTdWJtaXRCdXR0b24uVGV4dFNpemUgPSAxOApTdWJtaXRCdXR0b24uQXV0b0J1dHRvbkNvbG9yID0gdHJ1ZQpTdWJtaXRCdXR0b24uUGFyZW50ID0gTWFpbkZyYW1lCgpsb2NhbCBCdXR0b25Db3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKQnV0dG9uQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDI1KQpCdXR0b25Db3JuZXIuUGFyZW50ID0gU3VibWl0QnV0dG9uCgpsb2NhbCBCdXR0b25HcmFkaWVudCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIpCkJ1dHRvbkdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXd7CiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuMCwgQ29sb3IzLmZyb21SR0IoMCwgMjAwLCAxMDApKSwKICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMS4wLCBDb2xvcjMuZnJvbVJHQigwLCAxNjAsIDgwKSkKfQpCdXR0b25HcmFkaWVudC5Sb3RhdGlvbiA9IDkwCkJ1dHRvbkdyYWRpZW50LlBhcmVudCA9IFN1Ym1pdEJ1dHRvbgoKLS0gRXJyb3IgTGFiZWwgKOC4quC4s+C4q+C4o+C4seC4muC5geC4quC4lOC4h+C4guC5ieC4reC4hOC4p+C4suC4oeC5gOC4oeC4t+C5iOC4reC4hOC4teC4ouC5jOC4nOC4tOC4lCkKbG9jYWwgRXJyb3JMYWJlbCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKRXJyb3JMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIC0yMCwgMCwgMjUpCkVycm9yTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTAsIDAsIDMxMCkKRXJyb3JMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQpFcnJvckxhYmVsLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZApFcnJvckxhYmVsLlRleHQgPSAiIgpFcnJvckxhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDgwLCA4MCkKRXJyb3JMYWJlbC5UZXh0U2l6ZSA9IDE0CkVycm9yTGFiZWwuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkNlbnRlcgpFcnJvckxhYmVsLlZpc2libGUgPSBmYWxzZQpFcnJvckxhYmVsLlBhcmVudCA9IE1haW5GcmFtZQoKLS0g4LiV4Lix4Lin4LmB4Lib4Lij4Lia4Lit4LiB4Liq4LiW4Liy4LiZ4Liw4Lic4LmI4Liy4LiZ4LiB4Liy4Lij4LmA4LiK4LmH4LiEIEtleQpsb2NhbCBrZXlBY2NlcHRlZCA9IGZhbHNlCgotLSDguJ/guLHguIfguIHguYzguIrguLHguJkgRmFzdE1vZGUgKOC4peC4lOC4geC4o+C4suC4n+C4tOC4geC5guC4peC4pykKbG9jYWwgRmFzdE1vZGVFbmFibGVkID0gZmFsc2UKbG9jYWwgT3JpZ2luYWxTZXR0aW5ncyA9IHsKICAgIGxpZ2h0aW5nID0ge30sCiAgICB0ZXJyYWluID0ge30sCiAgICBpbnN0YW5jZXMgPSB7fQp9Cgpsb2NhbCBmdW5jdGlvbiBGYXN0TW9kZShtb2RlKQogICAgbG9jYWwgVGVycmFpbiA9IHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoJ1RlcnJhaW4nKQogICAgCiAgICBpZiBtb2RlID09ICJFTkFCTEUiIHRoZW4KICAgICAgICAtLSDguJrguLHguJnguJfguLbguIHguITguYjguLLguYDguJTguLTguKEKICAgICAgICBPcmlnaW5hbFNldHRpbmdzLmxpZ2h0aW5nLkdsb2JhbFNoYWRvd3MgPSBMaWdodGluZy5HbG9iYWxTaGFkb3dzCiAgICAgICAgT3JpZ2luYWxTZXR0aW5ncy5saWdodGluZy5Gb2dFbmQgPSBMaWdodGluZy5Gb2dFbmQKICAgICAgICBPcmlnaW5hbFNldHRpbmdzLmxpZ2h0aW5nLkJyaWdodG5lc3MgPSBMaWdodGluZy5CcmlnaHRuZXNzCiAgICAgICAgT3JpZ2luYWxTZXR0aW5ncy5saWdodGluZy5FbnZpcm9ubWVudERpZmZ1c2VTY2FsZSA9IExpZ2h0aW5nLkVudmlyb25tZW50RGlmZnVzZVNjYWxlCiAgICAgICAgT3JpZ2luYWxTZXR0aW5ncy5saWdodGluZy5FbnZpcm9ubWVudFNwZWN1bGFyU2NhbGUgPSBMaWdodGluZy5FbnZpcm9ubWVudFNwZWN1bGFyU2NhbGUKICAgICAgICBPcmlnaW5hbFNldHRpbmdzLmxpZ2h0aW5nLk91dGRvb3JBbWJpZW50ID0gTGlnaHRpbmcuT3V0ZG9vckFtYmllbnQKICAgICAgICAKICAgICAgICAtLSDguJXguLHguYnguIfguITguYjguLLguYLguKXguKfguIHguKPguLLguJ/guLTguIEKICAgICAgICBMaWdodGluZy5HbG9iYWxTaGFkb3dzID0gZmFsc2UKICAgICAgICBMaWdodGluZy5Gb2dFbmQgPSAyMDAKICAgICAgICBMaWdodGluZy5CcmlnaHRuZXNzID0gMQogICAgICAgIExpZ2h0aW5nLkVudmlyb25tZW50RGlmZnVzZVNjYWxlID0gMAogICAgICAgIExpZ2h0aW5nLkVudmlyb25tZW50U3BlY3VsYXJTY2FsZSA9IDAKICAgICAgICBMaWdodGluZy5PdXRkb29yQW1iaWVudCA9IENvbG9yMy5mcm9tUkdCKDEyOCwgMTI4LCAxMjgpCiAgICAgICAgCiAgICAgICAgLS0g4Lib4Li04LiU4LmA4Lit4Lif4LmA4Lif4LiB4LiV4LmM4LiV4LmI4Liy4LiH4LmGCiAgICAgICAgZm9yIF8sIGVmZmVjdCBpbiBwYWlycyhMaWdodGluZzpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBlZmZlY3Q6SXNBKCJCbG9vbUVmZmVjdCIpIG9yIGVmZmVjdDpJc0EoIkNvbG9yQ29ycmVjdGlvbkVmZmVjdCIpIG9yCiAgICAgICAgICAgICAgIGVmZmVjdDpJc0EoIlN1blJheXNFZmZlY3QiKSBvciBlZmZlY3Q6SXNBKCJEZXB0aE9mRmllbGRFZmZlY3QiKSBvciBlZmZlY3Q6SXNBKCJCbHVyRWZmZWN0IikgdGhlbgogICAgICAgICAgICAgICAgT3JpZ2luYWxTZXR0aW5ncy5pbnN0YW5jZXNbZWZmZWN0XSA9IGVmZmVjdC5FbmFibGVkCiAgICAgICAgICAgICAgICBlZmZlY3QuRW5hYmxlZCA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIC0tIOC4m+C4o+C4seC4miBUZXJyYWluCiAgICAgICAgaWYgVGVycmFpbiB0aGVuCiAgICAgICAgICAgIE9yaWdpbmFsU2V0dGluZ3MudGVycmFpbi5XYXRlcldhdmVTaXplID0gVGVycmFpbi5XYXRlcldhdmVTaXplCiAgICAgICAgICAgIE9yaWdpbmFsU2V0dGluZ3MudGVycmFpbi5XYXRlcldhdmVTcGVlZCA9IFRlcnJhaW4uV2F0ZXJXYXZlU3BlZWQKICAgICAgICAgICAgT3JpZ2luYWxTZXR0aW5ncy50ZXJyYWluLldhdGVyUmVmbGVjdGFuY2UgPSBUZXJyYWluLldhdGVyUmVmbGVjdGFuY2UKICAgICAgICAgICAgT3JpZ2luYWxTZXR0aW5ncy50ZXJyYWluLldhdGVyVHJhbnNwYXJlbmN5ID0gVGVycmFpbi5XYXRlclRyYW5zcGFyZW5jeQogICAgICAgICAgICAKICAgICAgICAgICAgVGVycmFpbi5XYXRlcldhdmVTaXplID0gMAogICAgICAgICAgICBUZXJyYWluLldhdGVyV2F2ZVNwZWVkID0gMAogICAgICAgICAgICBUZXJyYWluLldhdGVyUmVmbGVjdGFuY2UgPSAwCiAgICAgICAgICAgIFRlcnJhaW4uV2F0ZXJUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIAogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBPcmlnaW5hbFNldHRpbmdzLnRlcnJhaW4uRGVjb3JhdGlvbiA9IFRlcnJhaW4uRGVjb3JhdGlvbgogICAgICAgICAgICAgICAgVGVycmFpbi5EZWNvcmF0aW9uID0gZmFsc2UKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIC0tIOC4m+C4o+C4seC4muC4guC4reC4h+C5g+C4mSB3b3Jrc3BhY2UKICAgICAgICBmb3IgXywgb2JqIGluIHBhaXJzKHdvcmtzcGFjZTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICBpZiBvYmo6SXNBKCJQYXJ0aWNsZUVtaXR0ZXIiKSBvciBvYmo6SXNBKCJGaXJlIikgb3Igb2JqOklzQSgiU21va2UiKSBvciBvYmo6SXNBKCJUcmFpbCIpIG9yIG9iajpJc0EoIkJlYW0iKSB0aGVuCiAgICAgICAgICAgICAgICBPcmlnaW5hbFNldHRpbmdzLmluc3RhbmNlc1tvYmpdID0gb2JqLkVuYWJsZWQKICAgICAgICAgICAgICAgIG9iai5FbmFibGVkID0gZmFsc2UKICAgICAgICAgICAgZWxzZWlmIG9iajpJc0EoIlBvaW50TGlnaHQiKSBvciBvYmo6SXNBKCJTcG90TGlnaHQiKSBvciBvYmo6SXNBKCJTdXJmYWNlTGlnaHQiKSB0aGVuCiAgICAgICAgICAgICAgICBPcmlnaW5hbFNldHRpbmdzLmluc3RhbmNlc1tvYmpdID0gewogICAgICAgICAgICAgICAgICAgIFNoYWRvd3MgPSBvYmouU2hhZG93cywKICAgICAgICAgICAgICAgICAgICBCcmlnaHRuZXNzID0gb2JqLkJyaWdodG5lc3MsCiAgICAgICAgICAgICAgICAgICAgUmFuZ2UgPSBvYmouUmFuZ2UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG9iai5TaGFkb3dzID0gZmFsc2UKICAgICAgICAgICAgICAgIG9iai5CcmlnaHRuZXNzID0gbWF0aC5taW4ob2JqLkJyaWdodG5lc3MsIDAuNSkKICAgICAgICAgICAgICAgIG9iai5SYW5nZSA9IG1hdGgubWluKG9iai5SYW5nZSwgOCkKICAgICAgICAgICAgZWxzZWlmIG9iajpJc0EoIk1lc2hQYXJ0Iikgb3Igb2JqOklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBpZiBub3QgT3JpZ2luYWxTZXR0aW5ncy5pbnN0YW5jZXNbb2JqXSB0aGVuCiAgICAgICAgICAgICAgICAgICAgT3JpZ2luYWxTZXR0aW5ncy5pbnN0YW5jZXNbb2JqXSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgTWF0ZXJpYWwgPSBvYmouTWF0ZXJpYWwsCiAgICAgICAgICAgICAgICAgICAgICAgIFJlZmxlY3RhbmNlID0gb2JqLlJlZmxlY3RhbmNlLAogICAgICAgICAgICAgICAgICAgICAgICBDYXN0U2hhZG93ID0gb2JqLkNhc3RTaGFkb3cKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIG9iai5NYXRlcmlhbCA9IEVudW0uTWF0ZXJpYWwuUGxhc3RpYwogICAgICAgICAgICAgICAgb2JqLlJlZmxlY3RhbmNlID0gMAogICAgICAgICAgICAgICAgb2JqLkNhc3RTaGFkb3cgPSBmYWxzZQogICAgICAgICAgICBlbHNlaWYgb2JqOklzQSgiRGVjYWwiKSBvciBvYmo6SXNBKCJUZXh0dXJlIikgdGhlbgogICAgICAgICAgICAgICAgT3JpZ2luYWxTZXR0aW5ncy5pbnN0YW5jZXNbb2JqXSA9IG9iai5UcmFuc3BhcmVuY3kKICAgICAgICAgICAgICAgIG9iai5UcmFuc3BhcmVuY3kgPSAwLjgKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgRmFzdE1vZGVFbmFibGVkID0gdHJ1ZQogICAgICAgIFN0YXJ0ZXJHdWk6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICAgICAgVGl0bGUgPSAiRmFzdE1vZGUiLAogICAgICAgICAgICBUZXh0ID0gIuC5guC4peC4p+C4geC4o+C4suC4n+C4tOC4geC5gOC4m+C4tOC4lOC5geC4peC5ieC4pyAtIOC4m+C4o+C4sOC4quC4tOC4l+C4mOC4tOC4oOC4suC4nuC4quC4ueC4h+C4guC4tuC5ieC4mSIsCiAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgIH0pCiAgICAgICAgCiAgICBlbHNlaWYgbW9kZSA9PSAiRElTQUJMRSIgdGhlbgogICAgICAgIC0tIOC4hOC4t+C4meC4hOC5iOC4suC5gOC4lOC4tOC4oQogICAgICAgIGZvciBwcm9wLCB2YWx1ZSBpbiBwYWlycyhPcmlnaW5hbFNldHRpbmdzLmxpZ2h0aW5nKSBkbwogICAgICAgICAgICBMaWdodGluZ1twcm9wXSA9IHZhbHVlCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgZm9yIG9iaiwgdmFsdWUgaW4gcGFpcnMoT3JpZ2luYWxTZXR0aW5ncy5pbnN0YW5jZXMpIGRvCiAgICAgICAgICAgIGlmIG9iaiBhbmQgb2JqLlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICBpZiB0eXBlb2YodmFsdWUpID09ICJib29sZWFuIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgb2JqLkVuYWJsZWQgPSB2YWx1ZQogICAgICAgICAgICAgICAgZWxzZWlmIHR5cGVvZih2YWx1ZSkgPT0gInRhYmxlIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIHByb3AsIHZhbCBpbiBwYWlycyh2YWx1ZSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBvYmpbcHJvcF0gPSB2YWwgZW5kKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgb2JqLlRyYW5zcGFyZW5jeSA9IHZhbHVlIGVuZCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBpZiBUZXJyYWluIHRoZW4KICAgICAgICAgICAgZm9yIHByb3AsIHZhbHVlIGluIHBhaXJzKE9yaWdpbmFsU2V0dGluZ3MudGVycmFpbikgZG8KICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgVGVycmFpbltwcm9wXSA9IHZhbHVlIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgRmFzdE1vZGVFbmFibGVkID0gZmFsc2UKICAgICAgICBTdGFydGVyR3VpOlNldENvcmUoIlNlbmROb3RpZmljYXRpb24iLCB7CiAgICAgICAgICAgIFRpdGxlID0gIkZhc3RNb2RlIiwKICAgICAgICAgICAgVGV4dCA9ICLguITguLfguJnguITguYjguLLguIHguKPguLLguJ/guLTguIHguJvguIHguJXguLTguYHguKXguYnguKciLAogICAgICAgICAgICBEdXJhdGlvbiA9IDMKICAgICAgICB9KQogICAgZW5kCmVuZAoKLS0g4Lif4Lix4LiH4LiB4LmM4LiK4Lix4LiZIEZseSAo4Lia4Li04LiZ4LiZ4Li04LmI4LiH4LmGIOC4hOC4p+C4muC4hOC4uOC4oeC5hOC4lOC5iSkKbG9jYWwgRmx5QWN0aXZlID0gZmFsc2UKbG9jYWwgRmx5U3BlZWQgPSA4MApsb2NhbCBGbHlLZXlzID0ge1cgPSBmYWxzZSwgQSA9IGZhbHNlLCBTID0gZmFsc2UsIEQgPSBmYWxzZSwgVXAgPSBmYWxzZSwgRG93biA9IGZhbHNlfQpsb2NhbCBGbHlSb290LCBGbHlIdW1hbm9pZApsb2NhbCBGbHlEcml2ZQpsb2NhbCBGbHlUd2VlbkNvbm4KbG9jYWwgRmx5U3RlcCA9IDAuMDYKCmxvY2FsIGZ1bmN0aW9uIGFudGlJbnZpc2libGUoY2hhcmFjdGVyKQogICAgZm9yIF8sIHBhcnQgaW4gcGFpcnMoY2hhcmFjdGVyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgaWYgcGFydDpJc0EoIkJhc2VQYXJ0IikgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBwYXJ0LkxvY2FsVHJhbnNwYXJlbmN5TW9kaWZpZXIgPSAwCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlaWYgcGFydDpJc0EoIkRlY2FsIikgb3IgcGFydDpJc0EoIlRleHR1cmUiKSB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHBhcnQuVHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBzZXROb0NvbGxpZGUoY2hhcmFjdGVyLCBzdGF0ZSkKICAgIGZvciBfLCBwYXJ0IGluIHBhaXJzKGNoYXJhY3RlcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgcGFydC5DYW5Db2xsaWRlID0gbm90IHN0YXRlCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBiaW5kRmx5Q2hhcmFjdGVyKGNoYXJhY3RlcikKICAgIEZseUh1bWFub2lkID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKSBvciBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIsIDEwKQogICAgRmx5Um9vdCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIG9yIGNoYXJhY3RlcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiLCAxMCkKICAgIGFudGlJbnZpc2libGUoY2hhcmFjdGVyKQplbmQKCmJpbmRGbHlDaGFyYWN0ZXIocGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpKQpwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChiaW5kRmx5Q2hhcmFjdGVyKQoKbG9jYWwgZnVuY3Rpb24gc3RhcnRGbHkoKQogICAgaWYgRmx5QWN0aXZlIG9yIG5vdCBGbHlSb290IG9yIG5vdCBGbHlIdW1hbm9pZCB0aGVuIHJldHVybiBlbmQKICAgIAogICAgRmx5QWN0aXZlID0gdHJ1ZQogICAgRmx5SHVtYW5vaWQuUGxhdGZvcm1TdGFuZCA9IHRydWUKICAgIEZseUh1bWFub2lkLkF1dG9Sb3RhdGUgPSBmYWxzZQogICAgRmx5SHVtYW5vaWQuV2Fsa1NwZWVkID0gMAogICAgRmx5SHVtYW5vaWQuSnVtcFBvd2VyID0gMAogICAgc2V0Tm9Db2xsaWRlKHBsYXllci5DaGFyYWN0ZXIsIHRydWUpCiAgICBhbnRpSW52aXNpYmxlKHBsYXllci5DaGFyYWN0ZXIpCiAgICBGbHlSb290LkFuY2hvcmVkID0gdHJ1ZQogICAgCiAgICBGbHlEcml2ZSA9IEluc3RhbmNlLm5ldygiQ0ZyYW1lVmFsdWUiKQogICAgRmx5RHJpdmUuVmFsdWUgPSBGbHlSb290LkNGcmFtZQogICAgRmx5VHdlZW5Db25uID0gRmx5RHJpdmUuQ2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGNmKQogICAgICAgIGlmIEZseVJvb3QgdGhlbgogICAgICAgICAgICBGbHlSb290LkNGcmFtZSA9IGNmCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIFN0YXJ0ZXJHdWk6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICBUaXRsZSA9ICJGbHkiLAogICAgICAgIFRleHQgPSAi4LmA4Lib4Li04LiU4LmC4Lir4Lih4LiU4Lia4Li04LiZ4LmB4Lil4LmJ4LinIC0g4LmD4LiK4LmJIFdBU0QgKyBTcGFjZS9DdHJsIOC4hOC4p+C4muC4hOC4uOC4oSIsCiAgICAgICAgRHVyYXRpb24gPSAzCiAgICB9KQogICAgCiAgICBjb3JvdXRpbmUud3JhcChmdW5jdGlvbigpCiAgICAgICAgd2hpbGUgRmx5QWN0aXZlIGFuZCBGbHlEcml2ZSBkbwogICAgICAgICAgICBsb2NhbCBkaXJlY3Rpb24gPSBWZWN0b3IzLnplcm8KICAgICAgICAgICAgbG9jYWwgY2FtZXJhID0gd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEKICAgICAgICAgICAgbG9jYWwgbG9va1ZlY3RvciA9IGNhbWVyYS5DRnJhbWUuTG9va1ZlY3RvcgogICAgICAgICAgICBsb2NhbCByaWdodFZlY3RvciA9IGNhbWVyYS5DRnJhbWUuUmlnaHRWZWN0b3IKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIEZseUtleXMuVyB0aGVuIGRpcmVjdGlvbiA9IGRpcmVjdGlvbiArIGxvb2tWZWN0b3IgZW5kCiAgICAgICAgICAgIGlmIEZseUtleXMuUyB0aGVuIGRpcmVjdGlvbiA9IGRpcmVjdGlvbiAtIGxvb2tWZWN0b3IgZW5kCiAgICAgICAgICAgIGlmIEZseUtleXMuRCB0aGVuIGRpcmVjdGlvbiA9IGRpcmVjdGlvbiArIHJpZ2h0VmVjdG9yIGVuZAogICAgICAgICAgICBpZiBGbHlLZXlzLkEgdGhlbiBkaXJlY3Rpb24gPSBkaXJlY3Rpb24gLSByaWdodFZlY3RvciBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIHVwRG93biA9IDAKICAgICAgICAgICAgaWYgRmx5S2V5cy5VcCB0aGVuIHVwRG93biA9IHVwRG93biArIDEgZW5kCiAgICAgICAgICAgIGlmIEZseUtleXMuRG93biB0aGVuIHVwRG93biA9IHVwRG93biAtIDEgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBkaXJlY3Rpb24uTWFnbml0dWRlID4gMCB0aGVuCiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSBkaXJlY3Rpb24uVW5pdAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIGZsYXRMb29rID0gVmVjdG9yMy5uZXcobG9va1ZlY3Rvci5YLCAwLCBsb29rVmVjdG9yLlopCiAgICAgICAgICAgIGlmIGZsYXRMb29rLk1hZ25pdHVkZSA+IDAgdGhlbgogICAgICAgICAgICAgICAgZmxhdExvb2sgPSBmbGF0TG9vay5Vbml0CiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgY3VycmVudFBvcyA9IEZseURyaXZlLlZhbHVlLlBvc2l0aW9uCiAgICAgICAgICAgIGxvY2FsIGRlbHRhID0gKGRpcmVjdGlvbiAqIEZseVNwZWVkICsgVmVjdG9yMy5uZXcoMCwgdXBEb3duICogRmx5U3BlZWQsIDApKSAqIEZseVN0ZXAKICAgICAgICAgICAgbG9jYWwgdGFyZ2V0UG9zID0gY3VycmVudFBvcyArIGRlbHRhCiAgICAgICAgICAgIGxvY2FsIHRhcmdldENGcmFtZSA9IENGcmFtZS5uZXcodGFyZ2V0UG9zLCB0YXJnZXRQb3MgKyBmbGF0TG9vaykKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIHR3ZWVuID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShGbHlEcml2ZSwgVHdlZW5JbmZvLm5ldyhGbHlTdGVwLCBFbnVtLkVhc2luZ1N0eWxlLkxpbmVhciwgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwge1ZhbHVlID0gdGFyZ2V0Q0ZyYW1lfSkKICAgICAgICAgICAgdHdlZW46UGxheSgpCiAgICAgICAgICAgIAogICAgICAgICAgICB0YXNrLndhaXQoRmx5U3RlcCAqIDAuOTUpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgaWYgRmx5Um9vdCB0aGVuCiAgICAgICAgICAgIEZseVJvb3QuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kKSgpCmVuZAoKbG9jYWwgZnVuY3Rpb24gc3RvcEZseSgpCiAgICBpZiBub3QgRmx5QWN0aXZlIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICBGbHlBY3RpdmUgPSBmYWxzZQogICAgCiAgICBpZiBGbHlUd2VlbkNvbm4gdGhlbgogICAgICAgIEZseVR3ZWVuQ29ubjpEaXNjb25uZWN0KCkKICAgICAgICBGbHlUd2VlbkNvbm4gPSBuaWwKICAgIGVuZAogICAgCiAgICBpZiBGbHlEcml2ZSB0aGVuCiAgICAgICAgRmx5RHJpdmU6RGVzdHJveSgpCiAgICAgICAgRmx5RHJpdmUgPSBuaWwKICAgIGVuZAogICAgCiAgICBpZiBGbHlIdW1hbm9pZCB0aGVuCiAgICAgICAgRmx5SHVtYW5vaWQuUGxhdGZvcm1TdGFuZCA9IGZhbHNlCiAgICAgICAgRmx5SHVtYW5vaWQuQXV0b1JvdGF0ZSA9IHRydWUKICAgICAgICBGbHlIdW1hbm9pZC5XYWxrU3BlZWQgPSAxNgogICAgICAgIEZseUh1bWFub2lkLkp1bXBQb3dlciA9IDUwCiAgICBlbmQKICAgIAogICAgaWYgcGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgc2V0Tm9Db2xsaWRlKHBsYXllci5DaGFyYWN0ZXIsIGZhbHNlKQogICAgZW5kCiAgICAKICAgIGlmIEZseVJvb3QgdGhlbgogICAgICAgIEZseVJvb3QuQW5jaG9yZWQgPSBmYWxzZQogICAgZW5kCiAgICAKICAgIFN0YXJ0ZXJHdWk6U2V0Q29yZSgiU2VuZE5vdGlmaWNhdGlvbiIsIHsKICAgICAgICBUaXRsZSA9ICJGbHkiLAogICAgICAgIFRleHQgPSAi4Lib4Li04LiU4LmC4Lir4Lih4LiU4Lia4Li04LiZ4LmB4Lil4LmJ4LinIiwKICAgICAgICBEdXJhdGlvbiA9IDMKICAgIH0pCmVuZAoKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlRmx5KCkKICAgIGlmIEZseUFjdGl2ZSB0aGVuCiAgICAgICAgc3RvcEZseSgpCiAgICBlbHNlCiAgICAgICAgc3RhcnRGbHkoKQogICAgZW5kCmVuZAoKLS0gQ29udHJvbHMg4Liq4Liz4Lir4Lij4Lix4LiaIEZseQpVSVMuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0LCBnYW1lUHJvY2Vzc2VkKQogICAgaWYgZ2FtZVByb2Nlc3NlZCB0aGVuIHJldHVybiBlbmQKICAgIAogICAgbG9jYWwga2V5ID0gaW5wdXQuS2V5Q29kZQogICAgaWYga2V5ID09IEVudW0uS2V5Q29kZS5NIHRoZW4KICAgICAgICB0b2dnbGVGbHkoKQogICAgZWxzZWlmIGtleSA9PSBFbnVtLktleUNvZGUuVyB0aGVuCiAgICAgICAgRmx5S2V5cy5XID0gdHJ1ZQogICAgZWxzZWlmIGtleSA9PSBFbnVtLktleUNvZGUuQSB0aGVuCiAgICAgICAgRmx5S2V5cy5BID0gdHJ1ZQogICAgZWxzZWlmIGtleSA9PSBFbnVtLktleUNvZGUuUyB0aGVuCiAgICAgICAgRmx5S2V5cy5TID0gdHJ1ZQogICAgZWxzZWlmIGtleSA9PSBFbnVtLktleUNvZGUuRCB0aGVuCiAgICAgICAgRmx5S2V5cy5EID0gdHJ1ZQogICAgZWxzZWlmIGtleSA9PSBFbnVtLktleUNvZGUuU3BhY2UgdGhlbgogICAgICAgIEZseUtleXMuVXAgPSB0cnVlCiAgICBlbHNlaWYga2V5ID09IEVudW0uS2V5Q29kZS5MZWZ0Q29udHJvbCB0aGVuCiAgICAgICAgRmx5S2V5cy5Eb3duID0gdHJ1ZQogICAgZWxzZWlmIGtleSA9PSBFbnVtLktleUNvZGUuRjEgdGhlbgogICAgICAgIGlmIEZhc3RNb2RlRW5hYmxlZCB0aGVuCiAgICAgICAgICAgIEZhc3RNb2RlKCJESVNBQkxFIikKICAgICAgICBlbHNlCiAgICAgICAgICAgIEZhc3RNb2RlKCJFTkFCTEUiKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKClVJUy5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQsIGdhbWVQcm9jZXNzZWQpCiAgICBpZiBnYW1lUHJvY2Vzc2VkIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICBsb2NhbCBrZXkgPSBpbnB1dC5LZXlDb2RlCiAgICBpZiBrZXkgPT0gRW51bS5LZXlDb2RlLlcgdGhlbgogICAgICAgIEZseUtleXMuVyA9IGZhbHNlCiAgICBlbHNlaWYga2V5ID09IEVudW0uS2V5Q29kZS5BIHRoZW4KICAgICAgICBGbHlLZXlzLkEgPSBmYWxzZQogICAgZWxzZWlmIGtleSA9PSBFbnVtLktleUNvZGUuUyB0aGVuCiAgICAgICAgRmx5S2V5cy5TID0gZmFsc2UKICAgIGVsc2VpZiBrZXkgPT0gRW51bS5LZXlDb2RlLkQgdGhlbgogICAgICAgIEZseUtleXMuRCA9IGZhbHNlCiAgICBlbHNlaWYga2V5ID09IEVudW0uS2V5Q29kZS5TcGFjZSB0aGVuCiAgICAgICAgRmx5S2V5cy5VcCA9IGZhbHNlCiAgICBlbHNlaWYga2V5ID09IEVudW0uS2V5Q29kZS5MZWZ0Q29udHJvbCB0aGVuCiAgICAgICAgRmx5S2V5cy5Eb3duID0gZmFsc2UKICAgIGVuZAplbmQpCgotLSDguJ/guLHguIfguIHguYzguIrguLHguJnguKrguKPguYnguLLguIfguYHguKXguLDguYDguJvguLTguJQgVUkg4Lir4Lil4Lix4LiBICjguYDguKvguKHguLfguK3guJnguYDguJTguLTguKEgMTAwJSDguJ7guKPguYnguK3guKHguYDguJ7guLTguYjguKEgVXRpbGl0eSBTZWN0aW9uKQpsb2NhbCBmdW5jdGlvbiBjcmVhdGVNYWluVUkoKQogICAgbG9jYWwgTm90aGluZ0xpYnJhcnkgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldEFzeW5jKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vMzM0NS1jLWEtdC1zLXUtcy9OT1RISU5HL21haW4vc291cmNlLmx1YScpKSgpCiAgICBsb2NhbCBXaW5kb3dzID0gTm90aGluZ0xpYnJhcnkubmV3KHsKICAgICAgICBUaXRsZSA9ICJIYWlodWIiLAogICAgICAgIERlc2NyaXB0aW9uID0gIk5vdGhpbmcgVUkgTGlicmFyeSIsCiAgICAgICAgS2V5YmluZCA9IEVudW0uS2V5Q29kZS5MZWZ0Q29udHJvbCwKICAgICAgICBMb2dvID0gJ2h0dHA6Ly93d3cucm9ibG94LmNvbS9hc3NldC8/aWQ9MTg4OTg1ODI2NjInCiAgICB9KQogICAgbG9jYWwgbWFpblRhYiA9IFdpbmRvd3M6TmV3VGFiKHsKICAgICAgICBUaXRsZSA9ICJNYWluIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICJNYWluIGNhdGVnb3J5IiwKICAgICAgICBJY29uID0gInJieGFzc2V0aWQ6Ly83NzMzOTYwOTgxIgogICAgfSkKICAgIGxvY2FsIG1haW5TZWN0aW9uID0gbWFpblRhYjpOZXdTZWN0aW9uKHsKICAgICAgICBUaXRsZSA9ICJBdXRvRmFybSBTZWN0aW9uIiwKICAgICAgICBJY29uID0gInJieGFzc2V0aWQ6Ly83NzQzODY5MDU0IiwKICAgICAgICBQb3NpdGlvbiA9ICJMZWZ0IgogICAgfSkKICAgIAogICAgLS0g4LmA4Lie4Li04LmI4LihIFV0aWxpdHkgU2VjdGlvbiDguKrguLPguKvguKPguLHguJogRmFzdE1vZGUg4LmB4Lil4LiwIEZseQogICAgbG9jYWwgdXRpbGl0eVNlY3Rpb24gPSBtYWluVGFiOk5ld1NlY3Rpb24oewogICAgICAgIFRpdGxlID0gIlV0aWxpdHkgU2VjdGlvbiIsCiAgICAgICAgSWNvbiA9ICJyYnhhc3NldGlkOi8vNzc0Mzg2OTMyMiIsCiAgICAgICAgUG9zaXRpb24gPSAiUmlnaHQiCiAgICB9KQogICAgCiAgICAtLSBUb2dnbGUg4Liq4Liz4Lir4Lij4Lix4LiaIEZhc3RNb2RlCiAgICB1dGlsaXR5U2VjdGlvbjpOZXdUb2dnbGUoewogICAgICAgIFRpdGxlID0gIkZhc3RNb2RlICjguYLguKXguKfguIHguKPguLLguJ/guLTguIEpIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICLguKXguJTguIHguKPguLLguJ/guLTguIHguYDguJ7guLfguYjguK3guYDguJ7guLTguYjguKHguJvguKPguLDguKrguLTguJfguJjguLTguKDguLLguJ4gKEYxKSIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgICAgIGlmIHN0YXRlIHRoZW4KICAgICAgICAgICAgICAgIEZhc3RNb2RlKCJFTkFCTEUiKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBGYXN0TW9kZSgiRElTQUJMRSIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCwKICAgIH0pCiAgICAKICAgIC0tIFRvZ2dsZSDguKrguLPguKvguKPguLHguJogRmx5CiAgICB1dGlsaXR5U2VjdGlvbjpOZXdUb2dnbGUoewogICAgICAgIFRpdGxlID0gIkZseSAo4Lia4Li04LiZKSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAi4Lia4Li04LiZ4LiZ4Li04LmI4LiH4LmGIOC4hOC4p+C4muC4hOC4uOC4oeC4lOC5ieC4p+C4oiBXQVNEICsgU3BhY2UvQ3RybCAoTSkiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgICAgICBzdGFydEZseSgpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHN0b3BGbHkoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQsCiAgICB9KQogICAgCiAgICAtLSBTbGlkZXIg4Liq4Liz4Lir4Lij4Lix4Lia4Lib4Lij4Lix4Lia4LiE4Lin4Liy4Lih4LmA4Lij4LmH4Lin4Lia4Li04LiZCiAgICB1dGlsaXR5U2VjdGlvbjpOZXdTbGlkZXIoewogICAgICAgIFRpdGxlID0gIuC4hOC4p+C4suC4oeC5gOC4o+C5h+C4p+C4muC4tOC4mSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAi4Lib4Lij4Lix4Lia4LiE4Lin4Liy4Lih4LmA4Lij4LmH4Lin4LmD4LiZ4LiB4Liy4Lij4Lia4Li04LiZIiwKICAgICAgICBEZWZhdWx0ID0gRmx5U3BlZWQsCiAgICAgICAgTWluID0gMTAsCiAgICAgICAgTWF4ID0gMjAwLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgICAgIEZseVNwZWVkID0gdmFsdWUKICAgICAgICBlbmQsCiAgICB9KQogICAgCiAgICAtLSDguYLguITguYnguJQgQXV0b0Zhcm0g4LmA4LiU4Li04Lih4LiX4Lix4LmJ4LiH4Lir4Lih4LiUICjguYTguKHguYjguJXguLHguJQg4LmE4Lih4LmI4LmA4Lib4Lil4Li14LmI4Lii4LiZKQogICAgbG9jYWwgYXV0b2Zhcm1BY3RpdmUgPSBmYWxzZQogICAgbG9jYWwgdmltID0gZ2FtZTpHZXRTZXJ2aWNlKCdWaXJ0dWFsSW5wdXRNYW5hZ2VyJykKICAgIGxvY2FsIHRhcmdldFBhcnROYW1lID0gIkJhbGxTaGFkb3ciCiAgICBsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKICAgIGxvY2FsIGhlaWdodE11bHRpcGxpZXIgPSAzCiAgICBsb2NhbCBzYXZlUG9pbnRzID0gewogICAgICAgIFZlY3RvcjMubmV3KC02MzUuNjE3LCAtNTExLjMwMywgLTE2MS43NjApLAogICAgICAgIFZlY3RvcjMubmV3KC02NzQuMDA1LCAtNTExLjMwMywgLTE2MC44MzUpLAogICAgICAgIFZlY3RvcjMubmV3KC02OTguMjIzLCAtNTExLjMwMywgLTE3MS4zNzIpLAogICAgICAgIFZlY3RvcjMubmV3KC02MTEuODI4LCAtNTExLjMwMywgLTE3MC40ODkpLAogICAgICAgIFZlY3RvcjMubmV3KC02NTQuODgwLCAtNTExLjMwNiwgLTE2Ni45MzkpLAogICAgICAgIFZlY3RvcjMubmV3KC03MDAuMjE3LCAtNTExLjMwMywgMjYuMjE5KSwKICAgICAgICBWZWN0b3IzLm5ldygtNjU3LjAxOSwgLTUxMS4zMDMsIDI2LjYyMCksCiAgICAgICAgVmVjdG9yMy5uZXcoLTYxMS4wOTgsIC01MTEuMzAzLCAyNi44MzIpLAogICAgICAgIFZlY3RvcjMubmV3KC02MzUuMDgxLCAtNTExLjMwMywgMjUuOTYzKSwKICAgICAgICBWZWN0b3IzLm5ldygtNjczLjQ4MSwgLTUxMS4zMDMsIDI2LjA4MiksCiAgICB9CiAgICBsb2NhbCBpc1BhdXNlZCA9IGZhbHNlCiAgICBsb2NhbCBwYXVzZUR1cmF0aW9uID0gMwogICAgbG9jYWwgcGF1c2VEaXN0YW5jZSA9IDEwCiAgICBsb2NhbCBUZWFtcyA9IGdhbWU6R2V0U2VydmljZSgiVGVhbXMiKQogICAgbG9jYWwgZnVuY3Rpb24gaXNOZWFyU2F2ZVBvaW50KHBvc2l0aW9uKQogICAgICAgIGZvciBfLCBzcCBpbiBpcGFpcnMoc2F2ZVBvaW50cykgZG8KICAgICAgICAgICAgaWYgKHBvc2l0aW9uIC0gc3ApLk1hZ25pdHVkZSA8PSBwYXVzZURpc3RhbmNlIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCiAgICBsb2NhbCBmdW5jdGlvbiBmaW5kVGFyZ2V0KCkKICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyh3b3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgaWYgcGFydDpJc0EoIkJhc2VQYXJ0IikgYW5kIHBhcnQuTmFtZSA9PSB0YXJnZXRQYXJ0TmFtZSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gcGFydAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gbmlsCiAgICBlbmQKICAgIGxvY2FsIGZ1bmN0aW9uIGVuYWJsZUZseWluZyhjaGFyYWN0ZXIpCiAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICBodW1hbm9pZC5QbGF0Zm9ybVN0YW5kID0gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICBsb2NhbCBmdW5jdGlvbiBkaXNhYmxlRmx5aW5nKGNoYXJhY3RlcikKICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgIGh1bWFub2lkLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCiAgICBsb2NhbCBmdW5jdGlvbiBtb3ZlVG9UYXJnZXRGbHkocGFydCkKICAgICAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIGhycCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGlmIGhycCBhbmQgcGFydCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGJhc2VIZWlnaHQgPSBwYXJ0LlNpemUuWSAvIDIgKyA1CiAgICAgICAgICAgIGxvY2FsIGhlaWdodE9mZnNldCA9IGJhc2VIZWlnaHQgKiBoZWlnaHRNdWx0aXBsaWVyCiAgICAgICAgICAgIGhycC5DRnJhbWUgPSBDRnJhbWUubmV3KHBhcnQuUG9zaXRpb24gKyBWZWN0b3IzLm5ldygwLCBoZWlnaHRPZmZzZXQsIDApLCBwYXJ0LlBvc2l0aW9uKQogICAgICAgIGVuZAogICAgZW5kCiAgICBsb2NhbCBmdW5jdGlvbiBzcGFtRigpCiAgICAgICAgdmltOlNlbmRLZXlFdmVudCh0cnVlLCBFbnVtLktleUNvZGUuRiwgZmFsc2UsIGdhbWUpCiAgICAgICAgdmltOlNlbmRLZXlFdmVudChmYWxzZSwgRW51bS5LZXlDb2RlLkYsIGZhbHNlLCBnYW1lKQogICAgZW5kCiAgICBsb2NhbCBmdW5jdGlvbiBmaW5kQ2xvc2VzdEVuZW15UGxheWVyKCkKICAgICAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgICAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICBpZiBub3QgaHJwIHRoZW4gcmV0dXJuIG5pbCBlbmQKICAgICAgICBsb2NhbCBteVRlYW0gPSBwbGF5ZXIuVGVhbQogICAgICAgIGxvY2FsIGNsb3Nlc3RQbGF5ZXIgPSBuaWwKICAgICAgICBsb2NhbCBjbG9zZXN0RGlzdGFuY2UgPSBtYXRoLmh1Z2UKICAgICAgICBmb3IgXywgcGxyIGluIHBhaXJzKGdhbWUuUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgIGlmIHBsciB+PSBwbGF5ZXIgYW5kIHBsci5DaGFyYWN0ZXIgYW5kIHBsci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBhbmQgcGxyLlRlYW0gfj0gbXlUZWFtIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldEhSUCA9IHBsci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChocnAuUG9zaXRpb24gLSB0YXJnZXRIUlAuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgaWYgZGlzdCA8IGNsb3Nlc3REaXN0YW5jZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdERpc3RhbmNlID0gZGlzdAogICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RQbGF5ZXIgPSBwbHIKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gY2xvc2VzdFBsYXllcgogICAgZW5kCiAgICBsb2NhbCBmdW5jdGlvbiBmYWNlVGFyZ2V0KHRhcmdldFBvcykKICAgICAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIGhycCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGlmIGhycCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGxvb2tWZWN0b3IgPSAodGFyZ2V0UG9zIC0gaHJwLlBvc2l0aW9uKS5Vbml0CiAgICAgICAgICAgIGxvY2FsIG5ld0NGcmFtZSA9IENGcmFtZS5uZXcoaHJwLlBvc2l0aW9uLCBocnAuUG9zaXRpb24gKyBsb29rVmVjdG9yKQogICAgICAgICAgICBsb2NhbCBfLCB5YXcsIF8gPSBuZXdDRnJhbWU6VG9FdWxlckFuZ2xlc1lYWigpCiAgICAgICAgICAgIGxvY2FsIGN1cnJlbnRDRnJhbWUgPSBocnAuQ0ZyYW1lCiAgICAgICAgICAgIGhycC5DRnJhbWUgPSBDRnJhbWUubmV3KGN1cnJlbnRDRnJhbWUuUG9zaXRpb24pICogQ0ZyYW1lLkFuZ2xlcygwLCB5YXcsIDApCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGxvY2FsIGZ1bmN0aW9uIGF1dG9IaXQoKQogICAgICAgIGNvcm91dGluZS53cmFwKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgaWYgYXV0b2Zhcm1BY3RpdmUgYW5kIG5vdCBpc1BhdXNlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgc3BhbUYoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKSgpCiAgICAgICAgd2hpbGUgbm90IGF1dG9mYXJtQWN0aXZlIGRvCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZW5kCiAgICAgICAgZW5hYmxlRmx5aW5nKHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKSkKICAgICAgICB3aGlsZSBhdXRvZmFybUFjdGl2ZSBkbwogICAgICAgICAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBpZiBub3QgY2hhciB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgaWYgaHJwIHRoZW4KICAgICAgICAgICAgICAgIGlmIGlzTmVhclNhdmVQb2ludChocnAuUG9zaXRpb24pIGFuZCBub3QgaXNQYXVzZWQgdGhlbgogICAgICAgICAgICAgICAgICAgIGlzUGF1c2VkID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdChwYXVzZUR1cmF0aW9uKQogICAgICAgICAgICAgICAgICAgIGlzUGF1c2VkID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgbm90IGlzUGF1c2VkIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGVuZW15ID0gZmluZENsb3Nlc3RFbmVteVBsYXllcigpCiAgICAgICAgICAgICAgICBpZiBlbmVteSBhbmQgZW5lbXkuQ2hhcmFjdGVyIGFuZCBlbmVteS5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZmFjZVRhcmdldChlbmVteS5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0ID0gZmluZFRhcmdldCgpCiAgICAgICAgICAgICAgICBpZiB0YXJnZXQgdGhlbgogICAgICAgICAgICAgICAgICAgIG1vdmVUb1RhcmdldEZseSh0YXJnZXQpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgZW5kCiAgICAgICAgZGlzYWJsZUZseWluZyhwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkpCiAgICBlbmQKICAgIG1haW5TZWN0aW9uOk5ld1NsaWRlcih7CiAgICAgICAgVGl0bGUgPSAiSGVpZ2h0IE11bHRpcGxpZXIiLAogICAgICAgIERlZmF1bHQgPSBoZWlnaHRNdWx0aXBsaWVyLAogICAgICAgIE1pbiA9IDEsCiAgICAgICAgTWF4ID0gMTAsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICAgICAgaGVpZ2h0TXVsdGlwbGllciA9IHZhbHVlCiAgICAgICAgZW5kLAogICAgfSkKICAgIG1haW5TZWN0aW9uOk5ld1RvZ2dsZSh7CiAgICAgICAgVGl0bGUgPSAiQXV0byBGYXJtIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICAgICAgYXV0b2Zhcm1BY3RpdmUgPSBzdGF0ZQogICAgICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgICAgICBhdXRvSGl0KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kLAogICAgfSkKICAgIGxvY2FsIGF1dG9Nb25leUFjdGl2ZSA9IGZhbHNlCiAgICBsb2NhbCBTQ0FOX0lOVEVSVkFMID0gMwogICAgbG9jYWwgQ0xJQ0tfT0ZGU0VUX1kgPSAyMAogICAgbG9jYWwgY2xpY2tlZENhY2hlID0ge30KICAgIGxvY2FsIGxhc3RDYWNoZUZsdXNoID0gMAogICAgbG9jYWwgTUFYX01BUktFUlMgPSA0CiAgICBsb2NhbCBtYXJrZXJzID0ge30KICAgIGxvY2FsIFZJTSA9IGdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpCiAgICBsb2NhbCBmdW5jdGlvbiBuZXdNYXJrZXIoKQogICAgICAgIGxvY2FsIHNxID0gRHJhd2luZy5uZXcoIlNxdWFyZSIpCiAgICAgICAgc3EuVGhpY2tuZXNzID0gMgogICAgICAgIHNxLkZpbGxlZCA9IGZhbHNlCiAgICAgICAgc3EuVHJhbnNwYXJlbmN5ID0gMQogICAgICAgIHNxLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDApCiAgICAgICAgcmV0dXJuIHNxCiAgICBlbmQKICAgIGxvY2FsIGZ1bmN0aW9uIGNsZWFyTWFya2VycygpCiAgICAgICAgZm9yIF8sIG1hcmtlciBpbiBpcGFpcnMobWFya2VycykgZG8KICAgICAgICAgICAgaWYgbWFya2VyLmRyYXcgdGhlbgogICAgICAgICAgICAgICAgbWFya2VyLmRyYXc6UmVtb3ZlKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgdGFibGUuY2xlYXIobWFya2VycykKICAgIGVuZAogICAgbG9jYWwgZnVuY3Rpb24gYWRkTWFya2VyRm9yKGd1aU9iaikKICAgICAgICBpZiAjbWFya2VycyA+PSBNQVhfTUFSS0VSUyB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCBkcmF3ID0gbmV3TWFya2VyKCkKICAgICAgICB0YWJsZS5pbnNlcnQobWFya2Vycywge2luc3QgPSBndWlPYmosIGRyYXcgPSBkcmF3fSkKICAgIGVuZAogICAgbG9jYWwgZnVuY3Rpb24gdXBkYXRlTWFya2VycygpCiAgICAgICAgZm9yIGkgPSAjbWFya2VycywgMSwgLTEgZG8KICAgICAgICAgICAgbG9jYWwgbSA9IG1hcmtlcnNbaV0KICAgICAgICAgICAgbG9jYWwgaW5zdCA9IG0uaW5zdAogICAgICAgICAgICBsb2NhbCBkcmF3ID0gbS5kcmF3CiAgICAgICAgICAgIGlmIG5vdCBpbnN0IG9yIG5vdCBpbnN0LlBhcmVudCBvciBub3QgZHJhdyB0aGVuCiAgICAgICAgICAgICAgICBkcmF3OlJlbW92ZSgpCiAgICAgICAgICAgICAgICB0YWJsZS5yZW1vdmUobWFya2VycywgaSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgbG9jYWwgb2tQb3MsIHBvcyA9IHBjYWxsKGZ1bmN0aW9uKCkgcmV0dXJuIGluc3QuQWJzb2x1dGVQb3NpdGlvbiBlbmQpCiAgICAgICAgICAgICAgICBsb2NhbCBva1NpemUsIHNpemUgPSBwY2FsbChmdW5jdGlvbigpIHJldHVybiBpbnN0LkFic29sdXRlU2l6ZSBlbmQpCiAgICAgICAgICAgICAgICBsb2NhbCBva1ZpcywgdmlzID0gcGNhbGwoZnVuY3Rpb24oKSByZXR1cm4gaW5zdC5WaXNpYmxlIGVuZCkKICAgICAgICAgICAgICAgIGlmIG9rUG9zIGFuZCBva1NpemUgYW5kIG9rVmlzIGFuZCB2aXMgYW5kIHNpemUuWCA+IDAgYW5kIHNpemUuWSA+IDAgdGhlbgogICAgICAgICAgICAgICAgICAgIGRyYXcuVmlzaWJsZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICBkcmF3LlBvc2l0aW9uID0gVmVjdG9yMi5uZXcocG9zLlgsIHBvcy5ZKQogICAgICAgICAgICAgICAgICAgIGRyYXcuU2l6ZSA9IFZlY3RvcjIubmV3KHNpemUuWCwgc2l6ZS5ZKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGRyYXcuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGxvY2FsIGZ1bmN0aW9uIGlzQWN0dWFsbHlWaXNpYmxlKGd1aU9iaikKICAgICAgICBsb2NhbCBjdXJyZW50ID0gZ3VpT2JqCiAgICAgICAgd2hpbGUgY3VycmVudCBhbmQgY3VycmVudCB+PSBnYW1lIGRvCiAgICAgICAgICAgIGxvY2FsIG9rLCB2aXMgPSBwY2FsbChmdW5jdGlvbigpIHJldHVybiBjdXJyZW50LlZpc2libGUgZW5kKQogICAgICAgICAgICBpZiBvayBhbmQgbm90IHZpcyB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuUGFyZW50CiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgb2tQb3MsIHBvcyA9IHBjYWxsKGZ1bmN0aW9uKCkgcmV0dXJuIGd1aU9iai5BYnNvbHV0ZVBvc2l0aW9uIGVuZCkKICAgICAgICBsb2NhbCBva1NpemUsIHNpemUgPSBwY2FsbChmdW5jdGlvbigpIHJldHVybiBndWlPYmouQWJzb2x1dGVTaXplIGVuZCkKICAgICAgICBpZiBub3Qgb2tQb3Mgb3Igbm90IG9rU2l6ZSB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgICBpZiBzaXplLlggPD0gMCBvciBzaXplLlkgPD0gMCB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgICBsb2NhbCB2aWV3cG9ydCA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhIGFuZCB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5WaWV3cG9ydFNpemUgb3IgVmVjdG9yMi5uZXcoMTkyMCwgMTA4MCkKICAgICAgICBpZiBwb3MuWCA+IHZpZXdwb3J0Llggb3IgcG9zLlkgPiB2aWV3cG9ydC5ZIG9yIHBvcy5YICsgc2l6ZS5YIDwgMCBvciBwb3MuWSArIHNpemUuWSA8IDAgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogICAgbG9jYWwgZnVuY3Rpb24gZ2V0VGV4dE9mKG9iaikKICAgICAgICBsb2NhbCBvaywgdHh0ID0gcGNhbGwoZnVuY3Rpb24oKSByZXR1cm4gb2JqLlRleHQgZW5kKQogICAgICAgIGlmIG9rIGFuZCB0eXBlKHR4dCkgPT0gInN0cmluZyIgYW5kICN0eHQgPiAwIHRoZW4gcmV0dXJuIHR4dCBlbmQKICAgICAgICByZXR1cm4gbmlsCiAgICBlbmQKICAgIGxvY2FsIGZ1bmN0aW9uIHNhZmVDbGljayhpbnN0KQogICAgICAgIGxvY2FsIG5vdyA9IHRpY2soKQogICAgICAgIGlmIGNsaWNrZWRDYWNoZVtpbnN0XSBhbmQgbm93IC0gY2xpY2tlZENhY2hlW2luc3RdIDwgMC4yNSB0aGVuIHJldHVybiBlbmQKICAgICAgICBjbGlja2VkQ2FjaGVbaW5zdF0gPSBub3cKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHBvcyA9IGluc3QuQWJzb2x1dGVQb3NpdGlvbgogICAgICAgICAgICBsb2NhbCBzaXplID0gaW5zdC5BYnNvbHV0ZVNpemUKICAgICAgICAgICAgbG9jYWwgeCA9IHBvcy5YICsgc2l6ZS5YIC8gMgogICAgICAgICAgICBsb2NhbCB5ID0gcG9zLlkgKyBzaXplLlkgLyAyICsgQ0xJQ0tfT0ZGU0VUX1kKICAgICAgICAgICAgVklNOlNlbmRNb3VzZUJ1dHRvbkV2ZW50KHgsIHksIDAsIHRydWUsIGdhbWUsIDApCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjAyKQogICAgICAgICAgICBWSU06U2VuZE1vdXNlQnV0dG9uRXZlbnQoeCwgeSwgMCwgZmFsc2UsIGdhbWUsIDApCiAgICAgICAgZW5kKQogICAgZW5kCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRHdWlSb290cygpCiAgICAgICAgbG9jYWwgcm9vdHMgPSB7fQogICAgICAgIGxvY2FsIHBnID0gbmlsCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBwZyA9IHBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIsIDUpCiAgICAgICAgZW5kKQogICAgICAgIGlmIHBnIHRoZW4gdGFibGUuaW5zZXJ0KHJvb3RzLCBwZykgZW5kCiAgICAgICAgbG9jYWwgY2cgPSBuaWwKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGNnID0gZ2FtZTpHZXRTZXJ2aWNlKCJDb3JlR3VpIikKICAgICAgICBlbmQpCiAgICAgICAgaWYgY2cgdGhlbiB0YWJsZS5pbnNlcnQocm9vdHMsIGNnKSBlbmQKICAgICAgICByZXR1cm4gcm9vdHMKICAgIGVuZAogICAgbG9jYWwgZnVuY3Rpb24gdGVsZXBvcnRUb1Bvc2l0aW9uKCkKICAgICAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgaHJwID0gY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGhycC5DRnJhbWUgPSBDRnJhbWUubmV3KDkzLjY1MSwgLTQ2MC4zNjIsIC03MC42MTkpCiAgICBlbmQKICAgIGxvY2FsIGZ1bmN0aW9uIGNsaWNrQnV0dG9uc1N0ZXAoKQogICAgICAgIGxvY2FsIGZpcnN0QnV0dG9uQ2xpY2tlZCA9IGZhbHNlCiAgICAgICAgbG9jYWwgc2Vjb25kQnV0dG9uQ2xpY2tlZCA9IGZhbHNlCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gZmluZEFuZENsaWNrQnV0dG9uV2l0aFRleHQodGV4dCkKICAgICAgICAgICAgbG9jYWwgcm9vdHMgPSBnZXRHdWlSb290cygpCiAgICAgICAgICAgIGZvciBfLCByb290IGluIGlwYWlycyhyb290cykgZG8KICAgICAgICAgICAgICAgIGZvciBfLCBvYmogaW4gaXBhaXJzKHJvb3Q6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiAob2JqOklzQSgiVGV4dExhYmVsIikgb3Igb2JqOklzQSgiVGV4dEJ1dHRvbiIpIG9yIG9iajpJc0EoIlRleHRCb3giKSkgYW5kIGlzQWN0dWFsbHlWaXNpYmxlKG9iaikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0eHQgPSBnZXRUZXh0T2Yob2JqKQogICAgICAgICAgICAgICAgICAgICAgICBpZiB0eHQgYW5kIHR4dDpsb3dlcigpOmZpbmQodGV4dDpsb3dlcigpLCAxLCB0cnVlKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlQ2xpY2sob2JqKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIGVuZAogICAgICAgIHRlbGVwb3J0VG9Qb3NpdGlvbigpCiAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgd2hpbGUgbm90IGZpcnN0QnV0dG9uQ2xpY2tlZCBhbmQgYXV0b01vbmV5QWN0aXZlIGRvCiAgICAgICAgICAgIGZpcnN0QnV0dG9uQ2xpY2tlZCA9IGZpbmRBbmRDbGlja0J1dHRvbldpdGhUZXh0KCIyIHYgMiIpCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgZW5kCiAgICAgICAgd2hpbGUgbm90IHNlY29uZEJ1dHRvbkNsaWNrZWQgYW5kIGF1dG9Nb25leUFjdGl2ZSBkbwogICAgICAgICAgICBzZWNvbmRCdXR0b25DbGlja2VkID0gZmluZEFuZENsaWNrQnV0dG9uV2l0aFRleHQoImZpbmQgbWF0Y2giKQogICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgIGVuZAogICAgZW5kCiAgICBsb2NhbCBmdW5jdGlvbiBzY2FuQW5kQ2xpY2tMb29wKCkKICAgICAgICB3aGlsZSBhdXRvTW9uZXlBY3RpdmUgZG8KICAgICAgICAgICAgbG9jYWwgc3VjY2VzcywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgcm9vdHMgPSBnZXRHdWlSb290cygpCiAgICAgICAgICAgICAgICBsb2NhbCBmb3VuZExpc3QgPSB7fQogICAgICAgICAgICAgICAgbG9jYWwgaXNKb2luRm91bmQgPSBmYWxzZQogICAgICAgICAgICAgICAgbG9jYWwgTUFUQ0hfV09SRCA9ICJqb2luIgogICAgICAgICAgICAgICAgZm9yIF8sIHJvb3QgaW4gaXBhaXJzKHJvb3RzKSBkbwogICAgICAgICAgICAgICAgICAgIGZvciBfLCBvYmogaW4gaXBhaXJzKHJvb3Q6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iajpJc0EoIlRleHRMYWJlbCIpIG9yIG9iajpJc0EoIlRleHRCdXR0b24iKSBvciBvYmo6SXNBKCJUZXh0Qm94IikpIGFuZCBpc0FjdHVhbGx5VmlzaWJsZShvYmopIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHR4dCA9IGdldFRleHRPZihvYmopCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0eHQgYW5kIHR4dDpsb3dlcigpOmZpbmQoTUFUQ0hfV09SRCwgMSwgdHJ1ZSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChmb3VuZExpc3QsIG9iaikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0pvaW5Gb3VuZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgY2xlYXJNYXJrZXJzKCkKICAgICAgICAgICAgICAgIGZvciBpLCBpbnN0IGluIGlwYWlycyhmb3VuZExpc3QpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgaSA8PSBNQVhfTUFSS0VSUyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFkZE1hcmtlckZvcihpbnN0KQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIGlzSm9pbkZvdW5kIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgc2FmZUNsaWNrKGluc3QpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHVwZGF0ZU1hcmtlcnMoKQogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICAgICAgICAgIHdhcm4oIltBdXRvIE1vbmV5XSBlcnJvcjoiLCBlcnIpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB0YXNrLndhaXQoU0NBTl9JTlRFUlZBTCkKICAgICAgICBlbmQKICAgIGVuZAogICAgbWFpblNlY3Rpb246TmV3VG9nZ2xlKHsKICAgICAgICBUaXRsZSA9ICJBdXRvIE1vbmV5IiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKICAgICAgICAgICAgYXV0b01vbmV5QWN0aXZlID0gc3RhdGUKICAgICAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICAgICAgY29yb3V0aW5lLndyYXAoY2xpY2tCdXR0b25zU3RlcCkoKQogICAgICAgICAgICAgICAgY29yb3V0aW5lLndyYXAoc2NhbkFuZENsaWNrTG9vcCkoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQsCiAgICB9KQplbmQKCi0tIOC5gOC4oeC4t+C5iOC4reC4geC4lOC4m+C4uOC5iOC4oSBTdWJtaXQKU3VibWl0QnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgbG9jYWwgZW50ZXJlZEtleSA9IEtleVRleHRCb3guVGV4dAogICAgaWYgZW50ZXJlZEtleSA9PSBSRVFVSVJFRF9LRVkgdGhlbgogICAgICAgIFZhbGlkYXRlS2V5VUk6RGVzdHJveSgpCiAgICAgICAga2V5QWNjZXB0ZWQgPSB0cnVlCiAgICAgICAgY3JlYXRlTWFpblVJKCkKICAgICAgICAtLSDguYDguK3guLIgYXV0byBlbmFibGUg4Lit4Lit4LiBICjguYHguIHguYnguYHguITguYjguJXguKPguIfguJnguLXguYkpCiAgICBlbHNlCiAgICAgICAgS2V5VGV4dEJveC5UZXh0ID0gIiIKICAgICAgICBLZXlUZXh0Qm94LlBsYWNlaG9sZGVyVGV4dCA9ICLinYwg4LiE4Li14Lii4LmM4LmE4Lih4LmI4LiW4Li54LiB4LiV4LmJ4Lit4LiHIOC4geC4o+C4uOC4k+C4suC4peC4reC4h+C5g+C4q+C4oeC5iCIKICAgICAgICBFcnJvckxhYmVsLlRleHQgPSAi8J+bkSDguITguLXguKLguYzguJzguLTguJQhIOC4geC4o+C4uOC4k+C4suC4leC4o+C4p+C4iOC4quC4reC4muC5geC4peC4sOC5g+C4quC5iOC5g+C4q+C4oeC5iOC4reC4teC4geC4hOC4o+C4seC5ieC4hyIKICAgICAgICBFcnJvckxhYmVsLlZpc2libGUgPSB0cnVlCiAgICAgICAgCiAgICAgICAgLS0g4LiL4LmI4Lit4LiZ4LiC4LmJ4Lit4LiE4Lin4Liy4LihIGVycm9yIOC4q+C4peC4seC4h+C4iOC4suC4gSAzIOC4p+C4tOC4meC4suC4l+C4tQogICAgICAgIHRhc2sud2FpdCgzKQogICAgICAgIEVycm9yTGFiZWwuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgS2V5VGV4dEJveC5QbGFjZWhvbGRlclRleHQgPSAi8J+UkSDguIHguKPguK3guIHguITguLXguKLguYzguJfguLXguYjguJnguLXguYguLi4iCiAgICBlbmQKZW5kKQoKLS0g4Lij4Lit4LiH4Lij4Lix4Lia4LiB4Liy4Lij4LiB4LiUIEVudGVyIOC5g+C4meC4iuC5iOC4reC4h+C5g+C4quC5iOC4hOC4teC4ouC5jApLZXlUZXh0Qm94LkZvY3VzTG9zdDpDb25uZWN0KGZ1bmN0aW9uKGVudGVyUHJlc3NlZCkKICAgIGlmIGVudGVyUHJlc3NlZCB0aGVuCiAgICAgICAgU3VibWl0QnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkZpcmUoKQogICAgZW5kCmVuZCkK'
    local result = ""
    
    data = data:gsub('[^'..b64chars..'=]', '')
    
    for i = 1, #data, 4 do
        local a, b, c, d = data:byte(i, i+3)
        if not a then break end
        
        local v = (b64chars:find(string.char(a)) - 1) * 262144
        if b then v = v + (b64chars:find(string.char(b)) - 1) * 4096 end
        if c then v = v + (b64chars:find(string.char(c)) - 1) * 64 end  
        if d then v = v + (b64chars:find(string.char(d)) - 1) end
        
        result = result .. string.char(math.floor(v / 65536))
        if c then result = result .. string.char(math.floor((v % 65536) / 256)) end
        if d then result = result .. string.char(v % 256) end
    end
    
    local padding = data:match('=*$')
    return result:sub(1, #result - #padding)
end

print("ğŸ”“ Decoding HaiHub...")

local success, decodedScript = pcall(function()
    return base64Decode(encoded)
end)

if success and decodedScript and #decodedScript > 100 then
    print("âœ… HaiHub loaded successfully!")
    loadstring(decodedScript)()
else
    warn("âŒ Failed to decode script")
    game.Players.LocalPlayer:Kick("HaiHub decode error - Please contact developer")
end
